import{u as nt}from"./quickShareStore-DAg6hWQ2.js";import{_ as J,b as p,G as S,g as l,al as O,I as U,H as I,X as F,c as T,e,f as t,m as k,p as $,q as r,j as o,V as x,K as z,C as V,r as g,o as it,x as dt,a6 as ut,a4 as rt,a2 as L,B as M,z as Q,A as E,a5 as ct}from"./index-TexIIK_8.js";import{V as R}from"./VSpacer-CEFGUlLq.js";import{V as Y}from"./VDialog-RfSF4Tuc.js";import{V as G,c as K,a as W,b as X,d as mt}from"./VList-74BXSDpy.js";import{V as ft}from"./VSelect-Ca4HzIFK.js";import{V as vt}from"./VTextarea-CB8mBJHe.js";import"./dialog-transition-D7ZCLFfu.js";import"./ssrBoot-CLhRb1dG.js";import"./VMenu-B2YbBVxG.js";import"./VChip-Bkw_wO1V.js";const pt={},_t={class:"skeleton-container"},gt={class:"pa-4"};function xt(c,u){return p(),S("div",_t,[l("div",gt,[u[2]||(u[2]=O('<div class="skeleton-title mb-3" data-v-d1380f18></div><div class="skeleton-subtitle mb-4" data-v-d1380f18></div><div class="amount-section pa-6 rounded-lg bg-grey-lighten-4 mb-6" data-v-d1380f18><div class="skeleton-amount mb-2" data-v-d1380f18></div><div class="skeleton-per-person" data-v-d1380f18></div></div><div class="d-flex align-center mb-6" data-v-d1380f18><div class="skeleton-avatar mr-3" data-v-d1380f18></div><div class="flex-grow-1" data-v-d1380f18><div class="skeleton-text mb-1" data-v-d1380f18></div><div class="skeleton-text-sm" data-v-d1380f18></div></div></div>',4)),(p(),S(U,null,I(3,m=>l("div",{key:m,class:"d-flex align-center mb-4"},u[0]||(u[0]=[O('<div class="skeleton-avatar-sm mr-3" data-v-d1380f18></div><div class="flex-grow-1" data-v-d1380f18><div class="skeleton-text mb-1" data-v-d1380f18></div><div class="skeleton-text-sm" data-v-d1380f18></div></div><div class="skeleton-chip" data-v-d1380f18></div>',3)]))),64)),(p(),S(U,null,I(2,m=>l("div",{key:`payment-${m}`,class:"payment-row mb-3"},u[1]||(u[1]=[l("div",{class:"skeleton-text"},null,-1),l("div",{class:"skeleton-amount-sm mt-2"},null,-1)]))),64))])])}const yt=J(pt,[["render",xt],["__scopeId","data-v-d1380f18"]]),ht={__name:"index",props:{modelValue:{type:Boolean,default:!1},title:{type:String,required:!0},message:{type:String,required:!0},persistent:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},confirmButtonText:{type:String,default:"Confirm"},cancelButtonText:{type:String,default:"Cancel"},confirmButtonColor:{type:String,default:"primary"},cancelButtonColor:{type:String,default:"grey"}},emits:["update:modelValue","confirm","cancel"],setup(c,{emit:u}){const m=c,y=u,h=F({get:()=>m.modelValue,set:C=>y("update:modelValue",C)}),B=()=>{y("confirm")},w=()=>{y("cancel"),m.loading||(h.value=!1)};return(C,b)=>(p(),T(Y,{modelValue:h.value,"onUpdate:modelValue":b[0]||(b[0]=A=>h.value=A),"max-width":"400",persistent:c.persistent},{default:e(()=>[t(k,null,{default:e(()=>[t($,{class:"text-h5 pa-4"},{default:e(()=>[r(o(c.title),1)]),_:1}),t(x,{class:"pa-4"},{default:e(()=>[l("p",null,o(c.message),1)]),_:1}),t(z,{class:"pa-4"},{default:e(()=>[t(R),t(V,{variant:"text",color:c.cancelButtonColor,onClick:w,disabled:c.loading},{default:e(()=>[r(o(c.cancelButtonText),1)]),_:1},8,["color","disabled"]),t(V,{color:c.confirmButtonColor,onClick:B,loading:c.loading},{default:e(()=>[r(o(c.confirmButtonText),1)]),_:1},8,["color","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","persistent"]))}},kt={key:0},bt={class:"text-h5"},Vt={class:"text-subtitle-2 text-grey"},wt={class:"amount-section pa-4 rounded-lg bg-grey-lighten-4 mb-4"},Ct={class:"text-h4 text-center text-primary font-weight-bold"},St={class:"text-subtitle-1 text-center text-grey"},Bt={class:"d-flex align-center"},At={class:"mr-2"},Dt={class:"summary-grid"},Pt={class:"text-h5 font-weight-bold text-primary mt-1"},Mt={class:"text-h5 font-weight-bold text-success mt-1"},Ft={class:"text-h5 font-weight-bold text-error mt-1"},Tt={class:"text-h5 font-weight-bold text-info mt-1"},Ut={class:"d-flex flex-column mb-2"},It={class:"d-flex align-center justify-space-between"},Lt={class:"text-subtitle-1"},$t={class:"text-subtitle-1 font-weight-bold"},zt={class:"d-flex align-center justify-space-between mt-1"},Rt={class:"text-caption text-grey"},Nt={class:"payment-details mb-4"},jt={class:"text-h6"},qt={class:"text-subtitle-1"},Ht={__name:"Show",setup(c){const u=g(!1),m=g(null),y=g(null),h=g(""),B=g(!1),w=g(!1),C=g(0),b=g(!1),A=g(!1),f=nt(),D=ut(),d=F(()=>f.getDetail),N=n=>`https://ui-avatars.com/api/?name=${encodeURIComponent(n)}&background=random`,Z=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),tt=()=>{console.log("Sharing bill:",bill.value.id)},et=()=>{A.value=!0,f.markAsSettled(D.params.id).then(()=>{A.value=!1,q(!1),f.fetchDetail(D.params.id)})},at=F(()=>f==null?void 0:f.paymentMethods),j=F(()=>{var n,a;return(n=d.value)!=null&&n.is_settled?d.value.total_amount:(a=d.value)==null?void 0:a.payment_break_downs.filter(s=>s.is_paid).reduce((s,i)=>s+i.amount,0)}),lt=F(()=>{var n;return((n=d.value)==null?void 0:n.total_amount)-j.value}),st=n=>{m.value=n,y.value=n.payment_method_id,h.value=n.note,C.value=n.is_paid,u.value=!0},q=n=>{w.value=n,console.log(w.value)},ot=()=>{B.value=!0;const n={payment_method_id:y.value,note:h.value,is_paid:!C.value};f.markPaidOrUnPaid(m.value.id,n).then(a=>{f.fetchDetail(D.params.id).then(()=>{B.value=!1,u.value=!1})})};return it(()=>{var n;(!((n=f.quickShareDetail)!=null&&n.id)||f.quickShareDetail.id!=D.params.id)&&(b.value=!0),f.fetchDetail(D.params.id).then(()=>{b.value=!1}).catch(a=>{b.value=!1}),f.fetchPaymentMethods()}),(n,a)=>(p(),T(dt,null,{default:e(()=>[b.value?(p(),S("div",kt,[t(yt)])):(p(),T(k,{key:1,class:"mx-auto","max-width":"800"},{default:e(()=>[t($,{class:"d-flex justify-space-between align-center"},{default:e(()=>{var s,i;return[l("div",null,[l("h2",bt,o(((s=d.value)==null?void 0:s.title)||"Untitled Bill"),1),l("p",Vt,o(Z((i=d.value)==null?void 0:i.created_at)),1)]),t(V,{icon:"mdi-share-variant",variant:"text",onClick:tt})]}),_:1}),t(x,null,{default:e(()=>{var s,i,_,H;return[l("div",wt,[l("div",Ct," Rs "+o((s=d.value)==null?void 0:s.total_amount.toFixed(2)),1),l("div",St," Rs "+o((i=d.value)==null?void 0:i.per_member_amount.toFixed(2))+" per person ",1)]),t(G,null,{default:e(()=>{var P;return[t(K,null,{default:e(()=>a[6]||(a[6]=[r("Members")])),_:1}),(p(!0),S(U,null,I((P=d.value)==null?void 0:P.bill_members,v=>(p(),T(W,{key:v.id},{prepend:e(()=>[t(Q,{color:"grey-lighten-1"},{default:e(()=>[t(E,{src:N(v==null?void 0:v.name)},null,8,["src"])]),_:2},1024)]),append:e(()=>[l("div",Bt,[l("span",At,"Rs "+o(v.amount.toFixed(2)),1)])]),default:e(()=>[t(X,null,{default:e(()=>[r(o(v==null?void 0:v.name),1)]),_:2},1024),t(mt,null,{default:e(()=>[r(o(v==null?void 0:v.email),1)]),_:2},1024)]),_:2},1024))),128))]}),_:1}),t(rt,{color:(_=d.value)!=null&&_.is_settled?"success":"info",icon:(H=d.value)!=null&&H.is_settled?"mdi-check-circle":"mdi-information",class:"mt-4"},{default:e(()=>{var P;return[r(o((P=d.value)!=null&&P.is_settled?"Bill has been fully settled":"Waiting for settlement"),1)]}),_:1},8,["color","icon"])]}),_:1}),t(L),t(k,{class:"mt-4 settlement-summary",flat:""},{default:e(()=>[t(x,null,{default:e(()=>[l("div",Dt,[t(k,{class:"summary-card total-card",elevation:"2"},{default:e(()=>[t(x,{class:"pa-4"},{default:e(()=>{var s;return[t(M,{icon:"mdi-cash-multiple",size:"32",class:"mb-2",color:"primary"}),a[7]||(a[7]=l("div",{class:"text-caption font-weight-medium"},"Total Amount",-1)),l("div",Pt," ₹"+o((s=d.value)==null?void 0:s.total_amount.toFixed(2)),1)]}),_:1})]),_:1}),t(k,{class:"summary-card settled-card",elevation:"2"},{default:e(()=>[t(x,{class:"pa-4"},{default:e(()=>{var s;return[t(M,{icon:"mdi-check-circle",size:"32",class:"mb-2",color:"success"}),a[8]||(a[8]=l("div",{class:"text-caption font-weight-medium"},"Settled Amount",-1)),l("div",Mt," ₹"+o((s=j.value)==null?void 0:s.toFixed(2)),1)]}),_:1})]),_:1}),t(k,{class:"summary-card remaining-card",elevation:"2"},{default:e(()=>[t(x,{class:"pa-4"},{default:e(()=>[t(M,{icon:"mdi-clock-outline",size:"32",class:"mb-2",color:"error"}),a[9]||(a[9]=l("div",{class:"text-caption font-weight-medium"},"Remaining",-1)),l("div",Ft," ₹"+o(lt.value.toFixed(2)),1)]),_:1})]),_:1}),t(k,{class:"summary-card per-person-card",elevation:"2"},{default:e(()=>[t(x,{class:"pa-4"},{default:e(()=>{var s;return[t(M,{icon:"mdi-account-cash",size:"32",class:"mb-2",color:"info"}),a[10]||(a[10]=l("div",{class:"text-caption font-weight-medium"},"Per Person",-1)),l("div",Tt," ₹"+o((s=d.value)==null?void 0:s.per_member_amount.toFixed(2)),1)]}),_:1})]),_:1})])]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(K,null,{default:e(()=>a[11]||(a[11]=[r("Payment Breakdown")])),_:1}),t(G,null,{default:e(()=>{var s;return[(p(!0),S(U,null,I((s=d.value)==null?void 0:s.payment_break_downs,i=>(p(),T(W,{key:i.id},{default:e(()=>[t(X,null,{default:e(()=>[l("div",Ut,[l("div",It,[l("span",Lt,o(i.from_member),1),l("span",$t,"₹"+o(i.amount.toFixed(2)),1)]),l("div",zt,[l("span",Rt,"to "+o(i.to_member),1),t(V,{class:ct(["payment-btn",{"is-paid":i.is_paid}]),color:i.is_paid?"success":"primary",variant:"elevated",size:"small",onClick:_=>st(i)},{default:e(()=>[t(M,{icon:i.is_paid?"mdi-check-circle":"mdi-currency-usd",class:"payment-icon"},null,8,["icon"]),r(" "+o(i.is_paid?"Paid":"Mark Paid")+" ",1),a[12]||(a[12]=l("div",{class:"payment-btn-overlay"},null,-1))]),_:2},1032,["class","color","onClick"])])])]),_:2},1024)]),_:2},1024))),128))]}),_:1}),t(L)]),_:1}),t(L),t(Y,{modelValue:u.value,"onUpdate:modelValue":a[3]||(a[3]=s=>u.value=s),"max-width":"400"},{default:e(()=>[t(k,null,{default:e(()=>[t($,{class:"text-h5 pa-4"},{default:e(()=>a[13]||(a[13]=[r(" Confirm Payment ")])),_:1}),t(x,{class:"pa-4"},{default:e(()=>{var s,i;return[l("div",Nt,[t(Q,{size:"64",class:"mb-2"},{default:e(()=>{var _;return[t(E,{src:N(((_=m.value)==null?void 0:_.from_member)||"")},null,8,["src"])]}),_:1}),l("div",jt,"₹"+o((s=m.value)==null?void 0:s.amount.toFixed(2)),1),l("div",qt,o((i=m.value)==null?void 0:i.from_member),1)]),t(ft,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=_=>y.value=_),items:at.value,"item-title":"name","item-value":"id",label:"Payment Method",variant:"outlined","prepend-inner-icon":"mdi-bank",class:"mb-4"},null,8,["modelValue","items"]),t(vt,{modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=_=>h.value=_),label:"Add a note (optional)",variant:"outlined",rows:"2"},null,8,["modelValue"])]}),_:1}),t(z,{class:"pa-4"},{default:e(()=>[t(R),t(V,{variant:"text",color:"grey",onClick:a[2]||(a[2]=s=>u.value=!1)},{default:e(()=>a[14]||(a[14]=[r(" Cancel ")])),_:1}),t(V,{color:"primary",onClick:ot,loading:B.value},{default:e(()=>[r(o(C.value?"Mark as Unpaid":"Mark as Paid"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(z,null,{default:e(()=>{var s;return[t(R),t(V,{onClick:a[4]||(a[4]=i=>q(!0)),disabled:(s=d.value)==null?void 0:s.is_settled,color:"primary","prepend-icon":"mdi-check-all"},{default:e(()=>a[15]||(a[15]=[r(" Mark All as Settled ")])),_:1},8,["disabled"])]}),_:1}),t(ht,{modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=s=>w.value=s),title:"Confirm Settlement",message:"Are you sure you want to mark all payments as settled?",loading:A.value,"confirm-button-text":"Mark as Settled",onConfirm:et,persistent:""},null,8,["modelValue","loading"])]),_:1}))]),_:1}))}},ee=J(Ht,[["__scopeId","data-v-ba6bb821"]]);export{ee as default};
